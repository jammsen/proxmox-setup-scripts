# ===== AMD GPU Passthrough Configuration =====
# Allow access to cgroup devices (DRI and KFD)
# Device numbers: 226 = DRI major, 235 = KFD major
# Adjust card0/card1 based on which card is the APU (from Phase 1, Step 1.1)
# Mount DRI devices (GPU devices)
# Mount KFD device (ROCm compute interface - required for ROCm)
# Allow system-level capabilities for GPU drivers
# Suppress capability drops to allow GPU driver access
# ===== End GPU Configuration =====
arch: amd64
cores: 8
features: nesting=1
hostname: ollama-docker-amd
memory: 8192
net0: name=eth0,bridge=vmbr0,firewall=1,gw=10.0.0.1,hwaddr=BC:24:11:F5:74:6A,ip=10.0.0.206/24,type=veth
ostype: ubuntu
rootfs: local-zfs:subvol-100-disk-0,size=160G
swap: 4096
tags: docker;ollama;amd
unprivileged: 0
lxc.cgroup2.devices.allow: c 226:1 rwm
lxc.cgroup2.devices.allow: c 226:128 rwm
lxc.cgroup2.devices.allow: c 235:* rwm
lxc.mount.entry: /dev/dri dev/dri none bind,optional,create=dir
lxc.mount.entry: /dev/kfd dev/kfd none bind,optional,create=file
lxc.apparmor.profile: unconfined
lxc.cap.drop:
